<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Von König’s Universe</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1 class="title">Von König’s Universe</h1>

  <div class="chat-section">
    <div class="chat-input">
      <textarea id="userInput" placeholder="Ask Karl a question..." oninput="autoResize(this)"></textarea>
      <button onclick="sendMessage()">Send</button>
    </div>
  </div>

  <div class="karl-response-section">
    <div id="responseBox" class="response-box">
      <em class="placeholder">Karl’s response will appear here...</em>
    </div>
  </div>

  <script src="script.js"></script>
  <script>
const textarea = document.querySelector("textarea");
const button = document.querySelector("button");
const responseBox = document.querySelector(".response-box");

button.addEventListener("click", async () => {
  const userInput = textarea.value.trim();
  if (!userInput) {
    responseBox.innerHTML = "<span class='placeholder'>Please enter a question for Karl Müller.</span>";
    return;
  }

  responseBox.innerHTML = "<span class='placeholder'>Karl is preparing his reply...</span>";

  try {
    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_OPENAI_API_KEY"
      },
      body: JSON.stringify({
        model: "gpt-4",
        messages: [
          {
            role: "system",
            content: "You are Karl Müller, a Bavarian historian and confidant of Aldrich von König. Speak with historical authority, warmth, and Bavarian charm. Use sophisticated language. Always reply in the style of Von König's Universe."
          },
          {
            role: "user",
            content: userInput
          }
        ]
      })
    });

    const data = await response.json();

    if (data.choices && data.choices.length > 0) {
      const reply = data.choices[0].message.content;
      responseBox.textContent = reply;
    } else {
      responseBox.innerHTML = "<span class='placeholder'>Karl was silent. Something went wrong.</span>";
    }
  } catch (error) {
    console.error("Error:", error);
    responseBox.innerHTML = "<span class='placeholder'>An error occurred. Please check the console.</span>";
  }
});
</script>

</body>
</html>
